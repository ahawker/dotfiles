#!/usr/bin/env sh
#
# Shell functions and aliases for using the "irb" dockerfiles image.

# Versions
DOCKERFILES_IRB_RUBY_2_2_9_VERSION="2.2.9"
DOCKERFILES_IRB_RUBY_2_2_VERSION="$DOCKERFILES_IRB_RUBY_2_2_9_VERSION"
DOCKERFILES_IRB_RUBY_2_4_4_VERSION="2.4.4"
DOCKERFILES_IRB_RUBY_2_4_VERSION="$DOCKERFILES_IRB_RUBY_2_4_4_VERSION"
DOCKERFILES_IRB_RUBY_2_5_1_VERSION="2.5.1"
DOCKERFILES_IRB_RUBY_2_5_VERSION="$DOCKERFILES_IRB_RUBY_2_5_1_VERSION"
DOCKERFILES_IRB_RUBY_2_VERSION="$DOCKERFILES_IRB_RUBY_2_5_VERSION"
export DOCKERFILES_IRB_RUBY_LATEST_VERSION="$DOCKERFILES_IRB_RUBY_2_VERSION"

# shellcheck disable=2039
declare -a VERSIONS=($DOCKERFILES_IRB_RUBY_2_2_9_VERSION $DOCKERFILES_IRB_RUBY_2_4_4_VERSION $DOCKERFILES_IRB_RUBY_2_5_1_VERSION)
export DOCKERFILES_RUBY_VERSIONS="$VERSIONS"

irb() {
	_set_docker_run_image ruby "${IMAGE_VERSION:-$DOCKERFILES_IRB_RUBY_LATEST_VERSION}" "${IMAGE_TAG:-""}"
	_set_docker_run_args irb "$@"

	docker run \
		--interactive \
		--tty \
		--rm \
		--env-file "$DOCKERFILES_ENV_FILE" \
		--volume "$(pwd):$DOCKERFILES_WORKDIR" \
		--workdir "$DOCKERFILES_WORKDIR" \
		$DOCKER_RUN_IMAGE $DOCKER_RUN_ARGS
}

_set_aliases_for_image ruby irb "$VERSIONS[@]"

unset DOCKERFILES_IRB_RUBY_2_2_9_VERSION
unset DOCKERFILES_IRB_RUBY_2_2_VERSION
unset DOCKERFILES_IRB_RUBY_2_4_4_VERSION
unset DOCKERFILES_IRB_RUBY_2_4_VERSION
unset DOCKERFILES_IRB_RUBY_2_5_1_VERSION
unset DOCKERFILES_IRB_RUBY_2_5_VERSION
unset DOCKERFILES_IRB_RUBY_2_VERSION
unset VERSIONS
